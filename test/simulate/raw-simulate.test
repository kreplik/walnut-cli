# Test raw instruction trace functionality for simulate command
# REQUIRES: soldb
# First deploy the contract, then simulate a function call with --raw flag
# RUN: %soldb simulate %{contract_address} "increment(uint256)" 4 --from 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --ethdebug-dir %{ethdebug_dir} --rpc %{rpc_url} --raw 2>&1 | FileCheck %s

# When using --raw flag, we should see individual EVM instructions
# CHECK: Contract: TestContract

# Check for execution trace header
# CHECK: Execution trace

# Check for the trace table header
# CHECK: Step | PC
# CHECK: Op
# CHECK: Gas
# CHECK: Stack

# Check that we see at least some EVM opcodes
# CHECK-DAG: PUSH1
# CHECK-DAG: MSTORE
# CHECK-DAG: CALLDATASIZE
