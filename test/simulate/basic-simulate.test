# Test basic soldb simulate functionality
# REQUIRES: soldb
# First deploy the contract, then simulate a function call
# RUN: %soldb simulate %{contract_address} "increment(uint256)" 4 --from 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --ethdebug-dir %{contract_address}:TestContract:%{ethdebug_dir} --rpc %{rpc_url} 2>&1 | FileCheck %s

# Check that we get the basic simulation output structure
# CHECK: Contract: TestContract
# CHECK: Function Call Trace:
# CHECK: Gas used:

# Check for the call stack header
# CHECK: Call Stack:
# CHECK: ------------------------------------------------------------

# Check that we see the increment function call
# CHECK: #0 TestContract::runtime_dispatcher
# CHECK: #1 increment
# CHECK: amount: 4

# Check for nested function calls
# CHECK: increment2 [internal]
# CHECK: increment3 [internal]

# Check for the footer
# CHECK: ------------------------------------------------------------
# CHECK: Use --raw flag to see detailed instruction trace
